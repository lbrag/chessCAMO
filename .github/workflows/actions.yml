name: Unit_Testing

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

jobs:
  install:
    runs-on: windows-latest

    steps:
    - uses: actions/checkout@v2

    - name: Install GoogleTest
      run : |
          cd ../
          git clone https://github.com/google/googletest.git
          cd ./googletest/googletest/
          cmake -G "MinGW Makefiles" ..
          mingw32-make
          cd ../../ # go back to github repo directory

  compile_link:
    needs: install

    runs-on: windows-latest

    steps:
    - uses: actions/checkout@v2

    - name: Compile & Link
      run: mingw32-make all_unit

  run:
    needs: compile_link

    runs-on: windows-latest

    steps:
    - uses: actions/checkout@v2

    - name: Run Tests
      run: .\unit.exe --gtests_color=yes
